<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport"
 content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>äº’å‹•æ¶ç­”å¤§è³½ Pro+</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>

<style>
body{
 margin:0;
 font-family:'PingFang TC','Microsoft JhengHei',sans-serif;
 background:#6c5ce7;
 color:white;
 display:flex;
 flex-direction:column;
 align-items:center;
}
.card{
 background:white;
 color:#2d3436;
 width:90%;
 max-width:480px;
 padding:20px;
 border-radius:20px;
 text-align:center;
}
.hidden{display:none}
input,button{
 width:100%;
 padding:14px;
 font-size:1.1rem;
 margin:8px 0;
}
button{
 background:#fdcb6e;
 border:none;
 border-radius:40px;
 font-weight:bold;
 cursor:pointer;
}
.qrcode{
 margin:16px 0;
}
.qrcode img{
 width:200px;
 max-width:100%;
}
</style>
</head>

<body>

<div class="card">

<!-- ç™»å…¥ -->
<div id="view-login">
 <h2 id="login-title"></h2>
 <input id="login-input">
 <button id="btn-join">ç™»å…¥</button>
</div>

<!-- å­¸å“¡ç­‰å¾… -->
<div id="view-wait" class="hidden">
 <h3>è«‹ç­‰å¾…ä¸»æŒäººé–‹å§‹éŠæˆ²</h3>
</div>

<!-- ä¸»æŒäºº -->
<div id="view-host" class="hidden">
 <h3>ä¸»æŒäººå¾Œå°</h3>
 <p>ğŸ“¢ è«‹å­¸å“¡æƒæä¸‹æ–¹ QR Code é€²å…¥éŠæˆ²</p>

 <div class="qrcode">
   <img src="QRCODE.png" alt="å­¸å“¡ç™»å…¥ QR Code">
 </div>

 <button id="btn-start">é–‹å§‹éŠæˆ²</button>
</div>

<!-- éŠæˆ²é–‹å§‹ç•«é¢ï¼ˆç¤ºæ„ï¼‰ -->
<div id="view-game" class="hidden">
 <h2>ğŸ® éŠæˆ²é–‹å§‹ï¼</h2>
</div>

</div>

<script>
/* ========= Firebase è¨­å®š ========= */
firebase.initializeApp({
 apiKey: "AIzaSyAMvRegqD33yBy6mcCl3sB9IK8efeECxHk",
 databaseURL: "https://exam-questions-1eb01-default-rtdb.asia-southeast1.firebasedatabase.app"
});
const db = firebase.database();
const gameStatusRef = db.ref("gameStatus");

/* ========= DOM ========= */
const loginTitle = document.getElementById('login-title');
const loginInput = document.getElementById('login-input');
const btnJoin    = document.getElementById('btn-join');
const btnStart   = document.getElementById('btn-start');

const viewLogin = document.getElementById('view-login');
const viewWait  = document.getElementById('view-wait');
const viewHost  = document.getElementById('view-host');
const viewGame  = document.getElementById('view-game');

/* ========= State ========= */
const isHost = window.location.search.includes('host=true');
const HOST_PASSWORD = "00000";

/* ========= Init ========= */
function initLoginUI(){
 if(isHost){
   loginTitle.innerText = "ğŸ”‘ ä¸»æŒäººç™»å…¥";
   loginInput.placeholder = "è«‹è¼¸å…¥ä¸»æŒäººå¯†ç¢¼";
   loginInput.type = "password";
 }else{
   loginTitle.innerText = "è«‹è¼¸å…¥éšŠä¼åç¨±";
   loginInput.placeholder = "éšŠä¼ / å§“å";
 }
}
initLoginUI();

/* ========= View Switch ========= */
function show(view){
 [viewLogin, viewWait, viewHost, viewGame].forEach(v =>
   v.classList.add('hidden')
 );
 view.classList.remove('hidden');
}

/* ========= Login ========= */
btnJoin.onclick = ()=>{
 const val = loginInput.value.trim();
 if(!val) return alert("ä¸å¯ç©ºç™½");

 if(isHost){
   if(val === HOST_PASSWORD){
     show(viewHost);
     gameStatusRef.set("waiting"); // é‡ç½®ç‹€æ…‹
   }else{
     alert("ä¸»æŒäººå¯†ç¢¼éŒ¯èª¤");
   }
 }else{
   show(viewWait);
 }
};

/* ========= Host Start Game ========= */
btnStart.onclick = ()=>{
 gameStatusRef.set("playing");
};

/* ========= Firebase å³æ™‚ç›£è½ ========= */
gameStatusRef.on("value", snap=>{
 const status = snap.val();
 if(status === "playing"){
   show(viewGame);
 }
});
</script>

</body>
</html>
