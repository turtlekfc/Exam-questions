<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport"
 content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>äº’å‹•æ¶ç­”å¤§è³½ Pro+</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>

<style>
:root{--primary:#6c5ce7;--accent:#fdcb6e;--danger:#ff7675;--success:#55efc4;--dark:#2d3436}
*{-webkit-tap-highlight-color:transparent}
body{
 margin:0;font-family:'PingFang TC','Microsoft JhengHei',sans-serif;
 background:radial-gradient(circle,#6c5ce7,#4834d4);
 color:white;display:flex;flex-direction:column;align-items:center
}
.hidden{display:none!important}
.header-container{margin:15px 0}
.title-wrap{display:flex;align-items:center;gap:10px}
.event-logo{height:42px}
.event-title{
 font-size:clamp(1.3rem,6vw,2.4rem);
 font-weight:900;color:var(--accent);
 text-shadow:2px 2px #d35400
}
.card{
 background:white;color:var(--dark);
 width:90%;max-width:480px;
 padding:20px;border-radius:25px;
 box-shadow:0 15px 35px rgba(0,0,0,.3)
}
.opt-btn{width:100%;padding:16px;margin:6px 0;border-radius:40px;border:none}
.host-fixed-tools{
 position:fixed;right:15px;bottom:15px;
 background:#000;color:white;
 padding:15px;border-radius:20px;
 display:flex;flex-direction:column;gap:8px;z-index:999
}
</style>
</head>

<body>

<!-- éŸ³æ•ˆ -->
<audio id="snd-ok" src="correct.mp3"></audio>
<audio id="snd-ng" src="wrong.mp3"></audio>

<!-- Header -->
<div class="header-container">
 <div class="title-wrap">
  <img src="logo.png" class="event-logo">
  <div class="event-title">å°å¤ªé™½é ˜è¢–ç‡Ÿ</div>
 </div>
</div>

<!-- ä¸»æŒäººå·¥å…· -->
<div id="host-global-tools" class="host-fixed-tools hidden">
 <button onclick="goTo('view-admin-qs')">ğŸ“š é¡Œåº«</button>
 <button onclick="hardReset()">ğŸ”„ é‡ç½®</button>
</div>

<div class="card">

<!-- ç™»å…¥ -->
<div id="view-login">
 <h2 id="login-title"></h2>
 <input id="username">
 <button id="btn-join">ç™»å…¥</button>
</div>

<!-- ä¸»æŒäººè¨­å®š -->
<div id="view-setup" class="hidden">
 <h3>ä¸»æŒäººè¨­å®š</h3>
 <input id="q-count" type="number" value="10">
 <input id="q-timer" type="number" value="15">
 <button onclick="goTo('view-instruction')">ä¸‹ä¸€æ­¥</button>
</div>

<!-- èªªæ˜ -->
<div id="view-instruction" class="hidden">
 <p>ç­‰å¾…ä¸»æŒäººé–‹å§‹â€¦</p>
 <div id="host-start" class="hidden">
  <button onclick="startGame()">ğŸ® é–‹å§‹éŠæˆ²</button>
 </div>
</div>

<!-- éŠæˆ² -->
<div id="view-game" class="hidden">
 <div id="q-content"></div>
 <div id="options"></div>
</div>

<!-- é¡Œåº« -->
<div id="view-admin-qs" class="hidden">
 <h3>é¡Œåº«ç¶­è­·</h3>
 <input id="new-q-text" placeholder="é¡Œç›®">
 <input id="new-q-opts" placeholder="é¸é … A,B,C">
 <input id="new-q-ans" placeholder="ç­”æ¡ˆ">
 <button onclick="addQ()">æ–°å¢</button>
 <div id="qs-list"></div>
 <button onclick="goTo('view-setup')">è¿”å›</button>
</div>

</div>

<script>
/* Firebase */
firebase.initializeApp({
 apiKey:"AIzaSyAMvRegqD33yBy6mcCl3sB9IK8efeECxHk",
 databaseURL:"https://exam-questions-1eb01-default-rtdb.asia-southeast1.firebasedatabase.app"
});
const db=firebase.database();
const isHost=location.search.includes('host=true');
let myName="";

/* ç™»å…¥ç•«é¢åˆå§‹åŒ– */
if(isHost){
 login-title.innerText="ğŸ”‘ ä¸»æŒäººç™»å…¥";
 username.placeholder="è«‹è¼¸å…¥ä¸»æŒäººå¯†ç¢¼";
}else{
 login-title.innerText="è«‹è¼¸å…¥éšŠä¼åç¨±";
 username.placeholder="éšŠä¼ / å§“å";
}

/* ç•«é¢åˆ‡æ› */
function goTo(id){
 document.querySelectorAll('.card>div').forEach(d=>d.classList.add('hidden'));
 document.getElementById(id).classList.remove('hidden');
}

/* ç™»å…¥ */
btn-join.onclick=()=>{
 const v=username.value.trim();
 if(!v)return;
 if(isHost){
  db.ref('adminPass').once('value',s=>{
   if(v===s.val()){
    myName="ç®¡ç†å“¡";
    host-global-tools.classList.remove('hidden');
    document.getElementById('host-start').classList.remove('hidden');
    goTo('view-setup');
   }else alert("å¯†ç¢¼éŒ¯èª¤");
  });
 }else{
  myName=v;
  goTo('view-instruction');
 }
};

/* é¡Œåº« */
function addQ(){
 db.ref('questions').push({
  type:'choice',
  question:new-q-text.value,
  options:new-q-opts.value,
  answer:new-q-ans.value
 });
}

/* é‡ç½® */
function hardReset(){
 if(confirm("ç¢ºå®šé‡ç½®ï¼Ÿ")){
  db.ref('game').remove();
  db.ref('players').remove();
  location.reload();
 }
}
</script>
</body>
</html>
